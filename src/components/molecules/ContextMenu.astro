<div class="context-menu"><slot /></div>

<style>
	.context-menu {
		position: fixed;
		top: 0;
		left: 0;
		z-index: calc(infinity);
		display: flex;
		opacity: 0;
		user-select: none;
		pointer-events: none;
		flex-direction: column;
		background-color: #5b4942;
		box-shadow: 0px 5px 15px 0px rgba(0, 0, 0, 0.35);
		border-radius: 10px;
		overflow: hidden;
		padding: 10px 0;
		transition-duration: 200ms;
		transition-property: opacity;
	}

	.open {
		opacity: 1;
		pointer-events: all;
	}
</style>

<script>
	const toggleMenu = () => {
		document.body.addEventListener("contextmenu", (e) => {
			const contextMenu = document.querySelector<HTMLDivElement>(".context-menu");
			if (contextMenu !== null) {
				contextMenu.style.left = e.pageX + "px";
				contextMenu.style.top = e.pageY + "px";
				contextMenu.classList.add("open");
			}
		});

		document.body.addEventListener("click", () => {
			const contextMenu = document.querySelector<HTMLDivElement>(".context-menu");
			if (contextMenu !== null) {
				contextMenu.classList.remove("open");
			}
		});
	};

	toggleMenu();

	document.addEventListener("astro:after-swap", toggleMenu);
</script>
